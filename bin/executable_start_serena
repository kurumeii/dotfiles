#!/bin/bash

# 1. Kill any existing instances to avoid port conflicts
pkill -f serena-mcp-server

# 2. Start the server
# We use 'nohup' and redirect to /dev/null to keep it silent
nohup uv run --directory ~/projects/serena-mcp serena-mcp-server --transport streamable-http --port 12345 --context ide > /dev/null 2>&1 &

# 3. Give it a second to initialize
sleep 2

# 4. Verify it is actually running
PID=$(pgrep -f serena-mcp-server)

if [ -z "$PID" ]; then
    echo "❌ Error: Server failed to start."
else
    echo "✅ Serena MCP Server started successfully (PID: $PID)"
fi
